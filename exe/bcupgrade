#!/usr/bin/env ruby
# frozen_string_literal: true

require 'bcupgrade'
require 'optparse'
require 'readline'

OptionParser.new do |opt|
  begin
    opt.program_name = File.basename($PROGRAM_NAME)
    opt.banner = "Usage: #{opt.program_name} [options] [cask1 cask2 ...]"

    options = {}
    opt.on('-d', '--dry-run', 'Check version without installing') do |v|
      options[:dry_run] = v
    end
    opt.on('-r', '--remove', 'Remove previous version with installing') do |v|
      options[:remove] = v
    end
    opt.on('-y', '--yes', 'Install cask without prompt') do |v|
      options[:install] = v
    end
    opt.on('-v', '--version', 'Show version number') do
      puts Bcupgrade::VERSION
      exit
    end

    args = opt.parse!(ARGV)

    Bcupgrade.run(options, args)
  rescue => e
    puts "Error: #{e}.\nSee #{opt}"
    exit
  end
end
